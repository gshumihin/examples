# Examples
1. [Basic (url) rules](#Базовые-правила)
  * [Синтаксис](#Синтаксис)
  * [Модификаторы](#Модификаторы)
 	  * [Базовые модификаторы](#Базовые-модификаторы)
        * [$domain](#domain)
        * [$third-party](#third-party)
        * [$popup](#popup)
        * [$match-case](#match-case)
        * [$image](#image)
        * [$stylesheet](#stylesheet)
        * [$xmlhttrequest](#xmlhttprequest)
        * [$empty](#empty)
        * [$mp4](#mp4)
    * [Параметры для правил-исключений](#Модификаторы-правил-исключений)
        * [$elemhide](#elemhide)
        * [$content](#content)
        * [$jsinject](#jsinject)
        * [$urlblock](#urlblock)
        * [$document](#document)
    * [Generic-правила](#generic-rules)
        * [$generichide](#generichide)
        * [$genericblock](#genericblock)
2. [RegExp rules](#regexp-support)
3. [Replace rules](#replace-rules)
4. [Правила сокрытия элементов](#Правила-сокрытия-элемeнтов)
  * [Синтаксис](#syntax-2)
  * [Примеры](#examples-1)
5. [CSS-injections](#css-injections)
  * [Синтаксис](#syntax-3)
  * [Примеры](#examples-2)
6. [JS rules](#javascript-rules)
  * [Синтаксис](#syntax-4)
  * [Примеры](#examples-3)
7. [HTML filtering rules](#html-filtering-rules)
  * [Синтаксис](#syntax-5)
  * [Примеры](#examples-4)
  * [Атрибуты](#attributes)


##  Базовые правила

Так называемые _"Основные правила"_ - самый простой вид правил. Эти правила предназначены для блокировки запросов на определенный URL. 
Основной принцип для этого типа правил достаточно прост: необходимо указать адрес, где необходимо убрать рекламу + дополнительные параметры.
В общем виде правило будет выглядеть следующим образом:

### Синтаксис

```
rule = [@@] pattern [ "$" modifiers ]
modifers = $modifier1,modifier2, ...
```

* **`pattern`** - паттерн состоит из URL-адреса и необязательных специальных символов. Возможные символы и их описание приведены [ниже](#pattern-special-chars)
* **`@@`** - модификатор, который используется для обозначения правил-исключений. С такого модификатора должны начинаться правила, отключающие фильтрацию.
* **`modifiers`** - Параметры, используемые для "уточнения" общего правила. Параметр начинается с символа "`$`".

#### Спецсимволы, используемые в паттерне

* **`||`** - Domain name anchor. Указывается перед URL-адресом, где будет блокироваться реклама. Позволяет не указывать все поддомены, на которых необходимо заблокировать рекламу. 
* **`*`** - Wildcard character. Символ, обозначающий "произвольный набор символов"
* **`^`** - указатель для разделительного символа
* **`|`** - указатель на конец адреса. Например, правило `swf|` будет блокировать `http://example.com/annoyingflash.swf` , но не `http://example.com/swf/index.html` .

#### Примеры

* `||example.com/ads/*`  - самое простое правило, которое просто блокирует запрос на URL.

* `@@||example.com$document` - наиболее общее правило-исключение. Именно это правило отключает всю возможную фильтрацию на example.com и всех поддоменах. Есть ряд параметров, которые так же можно использовать в правилах-исключения. Более подробно о правилах-исключениях и параметрах, которые могут в таких правилах использоваться, написано [ниже](#exception-rules-modifiers).
___

### Модификаторы

_Возможности, описанные в этом разделе, обычно используются опытными пользователями. Они расширяют возможности «Общих правил», но для их применения необходимо иметь начальное представление о работе браузера._

Вы можете изменить поведение «общего правила», используя дополнительные модификаторы. Список этих параметров располагается в конце правила за знаком доллара `$` и разделяется запятыми. 
Например:
```
||domain.com$popup,third-party
```


#### Базовые модификаторы

Приведенные ниже модификаторы являются наиболее простыми (для понимания) и часто применяемыми. Они не могут быть использованы в правилах-исключениях.

##### **`domain`**

Модификатор `domain` ограничивает действия правила списком доменов. 
Для того, чтобы указать множество доменов в одном правиле, можно использовать символ `|` как разделитель.
Чтобы правило _не применялось_ на определенных доменах, перед доменным именем необходимо добавить символ `~`.


_Examples:_

* `||baddomain.com/ads/banners*^$domain=example.com|example.ru` - блокировка контента на доменах `example.com` и `example.ru` 
* `||baddomain.com/ads*^$domain=~example.ru` - контент будет блокироваться на всех доменах, кроме `example.ru`
* `||baddomain.com/ads*^$domain=example.com|~foo.example.com` - в данном примере контент будет блокирвоаться на домене `example.com`, но не будет блокироваться на `foo.example.com`

##### **`third-party`**

Ограничение на сторонние/собственные запросы. Если указан модификатор `third-party`, то правило применяется лишь к запросам ресурсов из внешних источников.
`~third-party` ограничивает правило запросами из того же источника, что и открытая страница.

_Examples:_

* `||domain.com$third-party` - правило применяется на всех сайтах, кроме самого `domain.com`
* `||domain.com$~third-party` - такое правило уже будет применяться только на самом `domain.com`, но не на других сайтах

##### **`popup`**

Adguard будет пытаться закрыть браузерную вкладку для любого адреса, который подходит под правило с этим модификатором.

_Examples:_

* `||domain.com*^$popup` - при попытке перехода на сайт `http:\\domain.com` с любой страницы в браузере, новая вкладка, в которой должен открыться указанный сайт, будет закрыта  

##### **`match-case`**

Определяет правило, которое применяется только к адресам с совпадением регистра букв. По умолчанию регистр символов не учитывается.

_Examples:_

* `*/BannerAd.gif$match-case` - такео правило будет блокировать `http://example.com/BannerAd.gif`, но не `http://example.com/bannerad.gif`.

##### **`image`**

Блокирует все картинки на указанном домене.

_Examples:_

* `||domain.com^$image` - данное правило заблокирует все картинки на домене `domain.com`

##### **`stylesheet`**

Блокирует загрузку CSS-стилей. При использовании `@@` наоборот, разблокирует.

_Examples:_

* `||domain.com/stylesheets^*$stylesheet` - блокирует загрузку css-стилей на указанных URL.
* `@@||gooddomain.com^*$` - разблокирует все заблокированные стили на указанном домене.

##### **`xmlhttprequest`**

Блокирует xmlhttpsrequest-запрос (запрос, который браузер загружает без обновления страницы). 
Напрмер, такие запросы зачастую пользуются интернет-магазинами при применении выбранных вами фильтров.

_Examples:_

* `||example.com/Banners/*$xmlhttrequest` - блокирует xmlhttp запросы на указзаном URL
* `@@||example.ru^$xmlhttprequest` - разблокирует xmlhttp запросы на указанном домене 

##### **`empty`**

TBD: текст

_Examples:_

TBD: example

##### **`mp4`**

Заменяет видео на заглушку. Данный модификатор на текущий момент не поддерживается расширениями.

_Examples:_

* `||example.com/videos/*.mp4$mp4,domain=best-videos.com` - блокирует загрузку видео с URL `http://example.com/videos` на домене `http://best-videos.com`

#### Модификаторы правил-исключений

Модификаторы, описанные ниже, имеет смысл использовать только в правилах-исключениях. 
Такие правила должны начинаться с символа `@@`.

##### **`elemhide`**

Запрещает правила сокрытия элементов на страницах, подходящих под правило.
О правилах сокрытия элементов речь пойдет [ниже](#elemhide).

_Examples:_

* `@@||example.com^$elemhide` - отменяет все правила скорытия элементов для домена `example.com`

##### **`content`**

Запрещает правила фильтрации HTML-элементов на страницах, подходящих под правило.
О правилах фильтрации HTML-элементов речь пойдет [ниже](#html-filtering-rules).

_Examples:_

* `@@||domain.com^$content` - отменяет правила html фильтрации на домене `domain.com` 

##### **`jsinject`**

Запрещает добавление javascript-кода на страницу. 
О правилах для вставки javascript-кода речь пойдет ниже.
Также, javascript-код добавляется на страницу для работы _«помощника Adguard»_.
То есть, используя исключающие javascript-код правила, вы отключаете еще и "Помощника" на странице.

_Examples:_

* `@@||example.com^$jsinject` - отменяет все правила вставки javascript-кода для домена `example.com`

##### **`urlblock`**

Запрещает блокировку запросов, отправленных со страниц подходящих под это правило.

_Examples:_

* `@@||example.com^$urlblock` - запросы, отправленные с этого домена, больше не будет блокироваться.

##### **`document`**

Полностью запрещает фильтрацию на страницах, подходящих под правило. 
Эквивалентно одновременному использованию модификаторов `elemhide`, `content`, `urlblock` и `jsinject`.

_Examples:_

* `@@||example.com^$document` - Полностью отключает фильтрацию на домене `example.com`

#### Generic rules

Generic-праила - это правила, действие которых не ограничено конкретными доменами

_Examples_:

Например, следующие правила являются generic-правилами:
```
###banner
~domain.com###banner
||domain.com^
||domain.com^$domain=~example.ru
```
А вот такие правила уже не является generic-правилом:
```
domain.com###banner
||domain.com^$domain=example.ru
```

##### **`generichide`**

Разблокирует элементы, заблокированные generic-[правилами сокрытия элементов](#Правила-сокрытия-элемeнтов).

_Examples_:

* `@@||example.com^generichide` - разблокирует на домене `example.com` все элементы, скрытые generic-правилами.

##### **`genericblock`**

Разблокирует элементы, скрытые простыми URL generic-правилами.

_Examples:_

* `@@||example.com^$genericblock` - разблокирует на домене `example.com` все элементы, скрытые URL generic-правилами.

___
## RegExp support

Если вы хотите еще большей гибкости при составлении правил, вы можете использовать [регулярные выражения](https://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%B3%D1%83%D0%BB%D1%8F%D1%80%D0%BD%D1%8B%D0%B5_%D0%B2%D1%8B%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F).

Суть работы проста: найденные при помощи регекспа адреса, будут заблокированы. Так же, возможно использование параметров обычных URL-правил.

**_Важное замечание:_** с точки зрения производительности рекомендуется по возможности избегать использования регулярных выражений.

#### Syntax

```
rule = pattern [ $ modifiers ]
```
В случае RegExp правил, в `pattern` записывается само регулярное выражение.

_Exaple:_

* `/banner\d+/` - такое правило, например, подойдет для блокировки URL, модержащих `banner123` или `banner321`, но не будет работать для banners.
* `/banner\d+/$domain=example.com` - так же, как и правило из примера выше, будет блокировать адреса, подходящие под это правило, но уже только на домене `example.com`

___
## Replace rules

Данный вид правил предназначем для "подмены" контента. При помощи регулярных выражений указывается сначала, _что_ необходимо заменить, затем то, _на что_ будет произведена замена. 
При этом, не обязательно что-то вставлять на замену, можно просто заменить "ни на что".

#### Syntax

**TBD!!!!!!!**
```
rule = pattern [ $ replace ] [RegExp1][RegExp2] 
```

_Example:_

* `||domain.com/config.xml$replace=/(<Ad[\s\S]*?>)[\s\S]*<\/Ad>/\$1<\/Ad>/` - в данном примере тэг `Ad` "опорожнится"

```
<AdServingTemplate>
<Ad id="advert-1">
//ads config
</Ad>
</AdServingTemplate>
```


___
## Правила сокрытия элемeнтов

**_Важно:_** Для работы с правилами скрытия необходимы знания HTML и CSS. Фактически, правила скрытия — это просто CSS-селекторы. Adguard добавляет на страницу собственные стили, состоящие из правил скрытия. Ко всем CSS-селекторам применяется стиль {display:none!important}.

**Примечание:**
_Правила скрытия кардинально отличаются от обычных правил. Например, не поддерживаются привычные символы масок — они имеют другое значение и применение._

### Syntax

```
rule = [domains] "##" selector
domains = #( domain )
```

**Domains**

Домен не обязателен для указания. Если составить правило примерно следующим образом: `##.textad`, то оно будет блокирвоать класс `textad` для всех доменов.
Указать можно как один, так и множетво доменов. Если доменов множетсво, их необходимо перечислить через запятую: `domain1,domain2,domain3##.ads`
Для того, чтоб правило не работало на определенном домене, перед самим доменом необходимо добавить символ `~`. 

**Selector**

После списка доменов `##` является признаком правила скрытия. Далее следует указать селектор, который будет определять скрываемый элемент.
Почитать про css-селекторы можно, например, [тут](https://www.w3.org/wiki/CSS/Selectors).

### Examples

* `example.com##.textad` - заблокирует `div` с классом _`textad`_ `<div class=textad>` на домене `example.com`
* `example.com,example.ru,domain.com###adblock` - скроет элемент по его атрибуту _`id`_ `<div id="adblock">` на доменах `example.com, example.ru, domain.com`
* `~example.com##.textad` - заблокирует `div` с классом _`textad`_ `<div class=textad>` на всех доменах, кроме `example.com`

___
## CSS-injections

TBD: текст про вот это вот все

### Syntax

```
rule = pattern { options }
```

**Pattern:**

* URL
* special chars

**Options:**

TBD: some text about options

### Examples

```
example.com#@$#body { background-color: #333!important; }
```
___
## Javascript rules

Adguard поддерживает специальный тип правил, позволяющий вставить любой javascript-код на страницы интернет-сайтов.

### Syntax

```
rule = [ URL ] pattern
pattern = #%# (js-code)
```

* _patten_ - включает в себя указатель на использование javascript-кода `#%#` и после этого следует необходимый для вставки код
* _URL_ - необязательный элемент правила, так же можно использовать список доменов, просто перечислив их через запятую. Работа с домена происходит по аналогии с [правилами сокрытия элементов](#Правила-сокрытия-элементов)

### Examples

* `example.com#%#$('#somebanner').remove()` - Это правило означает, что в код всех страниц сайта `example.com` будет добавлен javascript-код:
```
<script type="text/javascript">
    $('#somebanner').remove();
</script>
```
* `example.com#%#(function() { ***JS code*** })();` - выполнится сразу(по возможности) при открытии страницы
* `example.com#%#AG_onLoad(function() { ***JS code*** });` - выполнится после загрузки страницы(ориентируется на событие DOMContentLoaded)

___
## HTML filtering rules

TBD: text

### Syntax

```
rule = pattern [ attribute ]
attribute = ....
```

### Examples

TBD: example

### Attributes

**loaded-script**

TBD: text

_Example_

TBD: example

**max-length**

TBD: text

_Example_

TBD: example

**min-length**

TBD: text

_Example_

TBD: example

**parent-elements**

TBD: text

_Example_

TBD: example

**parent-search-level**

TBD: text

_Example_

TBD: example